<a data-toggle="modal" href="#useracceptsModal-<%= reservation.id %>">Confirm</a>

<div class="modal hide" id="useracceptsModal-<%= reservation.id %>">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
    <h3>You must agree to <%= "#{Bar.find(Room.find(reservation.room_id).id).name}'s" %> reservation policy before confirming your reservation</h3>
  </div>
  <div class="modal-body">
    <p class=strong>Reservation policy:</p>
    <%= Bar.find(Room.find(reservation.room_id).id).respolicy.description.gsub(/\n/, '<br/>').html_safe %>
  </div>
  <div class="modal-footer">
    <%= form_for(reservation, url: user_accepts_reservation_path(reservation.id)) do |f| %>
      <div><% if reservation.cc_required == false %><br><% end %>
        <div style="float:left;">
          <div>
            <%= render 'shared/error_messages', object: f.object %>
            <%= f.check_box :respolicy_accepted, style: "float:left;margin-right:10px;" %>
            <%= f.label :respolicy_accepted, "I agree to #{Bar.find(Room.find(reservation.room_id).id).name}'s reservation policy",
              class: "strong", style: "float:left;font-weight:bold;cursor:pointer;" %>
          </div>
          <div id="respolicy_error" class="jquery_validation" style="text-align:left;">
            <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
          </div>
        </div>
        <div style="float:right;text-align:left;">
          <% if reservation.cc_required == true %>
            <div class="strong" style="margin-bottom:10px;"><%= "#{Bar.find(Room.find(reservation.room_id).id).name} requires a credit card number to confirm this reservation" %></div>
            <% if current_user.stripe_customer_id? %>
              <%= "Your #{current_user.stripe_card_type}: xxxxxx#{current_user.stripe_card_last4}" %> |
              <a href="javascript:void(0);" id="togglediv">Edit card info</a>
              <div id="editcard" style="display:none;margin-top:10px;">
                stripe edit fields
            <% else %>
              stripe create fields
            <% end %>
          <% end %>
          <div style="float:right;margin-top:30px;">
            <%= f.submit "Confirm reservation", class: "btn" %>
            <a href="#" class="btn" data-dismiss="modal">Close</a>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<style type="text/css">
  #useracceptsModal-<%= reservation.id %> .modal-body {
    max-height: 250px;
  }
  #useracceptsModal-<%= reservation.id %> {
    width: 900px; /* SET THE WIDTH OF THE MODAL */
    margin: -250px 0 0 -450px; /* CHANGE MARGINS TO ACCOMODATE THE NEW WIDTH (original = margin: -250px 0 0 -280px;) */
  }
</style>

<script type="text/javascript">
  $(function(){
    $('#togglediv').click(function(){
       $('#editcard').toggle();
    });
  });
</script>