<a data-toggle="modal" href="#useracceptsModal-<%= reservation.id %>">Confirm</a>
<% bar = Bar.find(Room.find(reservation.room_id).bar_id) %>

<div class="modal hide" id="useracceptsModal-<%= reservation.id %>">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
    <h3><%= "#{bar.name} requires a credit card number to confirm this reservation" %></h3>
  </div>
  <%= form_for(reservation, url: user_accepts_reservation_path(reservation.id), html: { style: "margin-bottom:0;" }) do |f| %>
    <div class="modal-body">
      <% if reservation.cc_required == true %>
        <div id="card_required">
          <% if current_user.stripe_customer_id? %>
            <%= "Your #{current_user.stripe_card_type}: xxxxxx#{current_user.stripe_card_last4}" %> |
            <a href="javascript:void(0);" class="togglediv">Edit card info</a>
            <div class="edit_card" style="display:none;margin-top:10px;">
              <div style="float:left;margin-right:25px;">
                <%= label_tag :card_number, "Credit Card Number" %>
                <%= text_field_tag :card_number, nil, name: nil %>
              </div>
              <div>
                <%= label_tag :card_month, "Card Expiration" %>
                <%= select_month nil, {add_month_numbers_true: true}, {name: nil, id: "card_month", style: "width:100px"} %>
                <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year", style: "width:70px;margin-left:10px;"} %>
              </div>
              <div id="stripe_error" class="jquery_validation">
                <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
              </div>
              <%= f.hidden_field :stripe_card_token %>
            </div>
          <% else %>
            <div>
              <div style="float:left;margin-right:25px;">
                <%= label_tag :card_number, "Credit Card Number" %>
                <%= text_field_tag :card_number, nil, name: nil %>
              </div>
              <div>
                <%= label_tag :card_month, "Card Expiration" %>
                <%= select_month nil, {add_month_numbers_true: true}, {name: nil, id: "card_month", style: "width:100px"} %>
                <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year", style: "width:70px;margin-left:10px;" } %>
              </div>
            </div>
            <div id="stripe_error" class="jquery_validation">
              <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
            </div>
            <%= f.hidden_field :stripe_card_token %>
          <% end %>
        </div>
      <% end %>
    </div>
    <div class="modal-footer">
      <%= f.submit "Confirm reservation", class: "btn" %>
      <a href="#" class="btn" data-dismiss="modal">Close</a>
    </div>
  <% end %>
</div>

<style type="text/css">
  #useracceptsModal-<%= reservation.id %> .modal-body {
    max-height: 250px;
  }
  #useracceptsModal-<%= reservation.id %> {
    width: 600px; /* SET THE WIDTH OF THE MODAL */
    margin: -200px 0 0 -300px; /* CHANGE MARGINS TO ACCOMODATE THE NEW WIDTH (original = margin: -250px 0 0 -280px;) */
  }
</style>